<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Auto-upload Jekyll after pushing to GitHub</title><meta name="description" content=""><meta name="author" content="Rémy Gardette"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="google-site-verification" content="7-sInCicLv1ZVadM2GHwwPUIr-2KgqNbsHA9Pl31zr0"/> <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]--><link href="/assets/themes/flat/bootstrap/css/bootstrap.min.css" rel="stylesheet"><link href="/assets/themes/flat/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet"><link href="/assets/themes/flat/css/font-awesome.min.css" rel="stylesheet"><link href="/assets/themes/flat/css/pygments.css" rel="stylesheet"><link href="/assets/themes/flat/css/style.css?body=1" rel="stylesheet" type="text/css" media="all"><link href='http://fonts.googleapis.com/css?family=Dosis:700' rel='stylesheet' type='text/css'><link href='http://fonts.googleapis.com/css?family=Gudea:400,400italic,700' rel='stylesheet' type='text/css'><link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed"><link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed"><script>(function(){var e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.src="//api.flattr.com/js/0.6/load.js?mode=auto&button=compact&uid=ramy&category=text",t.parentNode.insertBefore(e,t)})()</script></head><body><div class="navbar navbar-fixed-top navbar-inverse"><div class="navbar-inner"><div class="container"> <btn class="btn btn-navbar collapsed" data-toggle="collapse" data-target=".nav-collapse" type="button"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </btn><a class="brand" href="/">Rémy Gardette</a><div class="nav-collapse collapse"><ul class="nav"><li><a href="http://blog.remyg.fr" class="dev">Blog</a></li><li><a href="/articles.html" class="dev">Articles</a></li><li><a href="/projects/index.html" class="dev">Projects</a></li><li><a href="/resume.html" class="pro">Resume</a></li><li><a href="/skills.html" class="pro">Skills</a></li><li><a href="/contact.html" class="misc">Contact</a></li><li><a href="/about.html" class="misc">About</a></li></ul></div></div></div></div><div class="container"><div class="content"><div class="page-header"><div class="row-fluid"><div class="span12"><h1>Auto-upload Jekyll after pushing to GitHub</h1></div></div></div><div class="row-fluid post-full"><div class="span9"><div class="date"> <strong>05 March 2013</strong></div></div><div class="span2 offset1"><div class="flattr-div"> <a class="FlattrButton" href="http://remyg.fr/2013/03/05/auto-upload-jekyll-after-pushing-to-github" title="Auto-upload Jekyll after pushing to GitHub" rel="flattr;tags:blog;"></a></div></div></div><div class="row-fluid post-full"><div class="span9"><div class="content"><p>My Jekyll site is hosted on a shared web hosting service, provided by OVH. It’s the most basic service, which consists of a PHP server, a MySql database, and that’s about it. The only way to change the files on the server is to access it via FTP, as there is no SSH connection available.</p><p>So, with the concept of Jekyll, which is to generate static HTML files and use them for the final web site, the only option I had was to manually upload the <code>_site</code> folder each time I made some changes in the source code. And this after pushing my changes to GitHub (the sources and generated files are stored in a public GitHub repository).</p><p>But I’ve actually found another way to automate the process. For this I need my personnal server, which is an old eeePc running Debian I have at home (but can’t use as a web server, for basic QoS reasons).</p><h2 id='clone_the_git_repository'>Clone the git repository</h2><p>I started by cloning the repository on my personnal server:</p><pre><code>$ cd /home/username
$ mkdir jekyll
$ git clone https://github.com/RemyG/remyg.fr.git jekyll</code></pre><p>This create a clone of the repository in <code>/home/username/jekyll</code>.</p><h2 id='create_the_ftp_upload_script'>Create the FTP upload script</h2><p>To automatically upload my files via FTP, I used <code>lftp</code>:</p><pre><code>$ sudo apt-get install lftp</code></pre><p>Then I’ve created the script used to upload my <code>_site</code> folder to the shared server:</p><pre><code>$ touch /usr/local/bin/ftp-upload-jekyll.sh
$ chmod +x /usr/local/bin/ftp-upload-jekyll.sh
$ vim /usr/local/bin/ftp-upload-jekyll.sh</code></pre><p>The content of the script is a simple <code>mirror</code> command:</p><pre><code>#!/bin/sh

lftp -u your_username,your_password your_host_url &lt;&lt;EOF

cd /dest_folder/_site # The distant directory
lcd /home/username/jekyll/_site # The local directory

mirror -R

quit 0

EOF</code></pre><p>When this script is executed, it will upload the content of the local <code>_site</code> folder on the host <code>your_host_url</code>.</p><h2 id='create_the_git_pull_script'>Create the git pull script</h2><p>Before uploading the website to the server, the repository has to be pulled. I’ve created a script for it:</p><pre><code>$ touch /usr/local/bin/github-pull-jekyll.sh
$ chmod +x /usr/local/bin/github-pull-jekyll.sh
$ vim /usr/local/bin/github-pull-jekyll.sh</code></pre><p>The content of the script is simply:</p><pre><code>#!/bin/sh

cd /home/username/jekyll
git pull</code></pre><p>When this script is executed, it will pull the repository.</p><h2 id='create_a_github_postreceive_hook'>Create a GitHub post-receive hook</h2><h3 id='on_my_personnal_server'>On my personnal server</h3><p>I’ve just created a PHP file, which is exposed on Internet.</p><pre><code>$ cd /var/www
$ vim github-hook.php</code></pre><p>The content of this file is very simple: first it pulls the repository, then it calls the script <code>ftp-upload-jekyll.sh</code> to upload the content of the <code>_site</code> folder to the shared server.</p><pre><code>&lt;?php
    `sh /usr/local/bin/github-pull-jekyll.sh`;
    `sh /usr/local/bin/ftp-upload-jekyll.sh`;
?&gt;</code></pre><h3 id='on_github'>On GitHub</h3><p>Then I just had to create the post-receive hook on GitHub, as described on the <a href='https://help.github.com/articles/post-receive-hooks'>GitHub documentation</a>. The WebHook URL is the URL of the PHP file on my personnal server.</p><h2 id='conclusion'>Conclusion</h2><p>Now, each time I push some changes to my GitHub repository, they are automatically uploaded to my web server, and instantly available to be browsed.</p></div></div><div class="span2 offset1"><div><ul class="tag_box inline"><li><i class="icon-folder-open"></i></li><li><a href="/categories.html#Web-ref"> Web </a></li></ul></div><div><ul class="tag_box inline"><li><i class="icon-tags"></i></li><li><a href="/tags.html#Jekyll-ref">Jekyll</a></li><li><a href="/tags.html#FTP-ref">FTP</a></li><li><a href="/tags.html#OVH-ref">OVH</a></li></ul></div><div class="post-sharing"><div class="pw-widget pw-vertical pw-counter-horizontal"> <a class="pw-button-twitter pw-look-native"></a> <a class="pw-button-googleplus pw-look-native"></a> <a class="pw-button-facebook pw-look-native"></a> <a class="pw-button-linkedin pw-look-native"></a></div> <script src="http://i.po.st/share/script/post-widget.js#publisherKey=eldbisvehq328hb84l66"></script></div></div></div><div class="row-fluid post-full"><hr><div class="pagination"><ul><li class="prev"><a href="/2013/03/05/use-flattr-with-wordpress-351" title="Use Flattr with Wordpress 3.5.1">← Previous</a></li><li><a href="/archive.html">Archive</a></li><li class="next"><a href="/2013/03/08/display-github-repositories-on-jekyll" title="Display GitHub repositories on Jekyll">Next →</a></li></ul></div><hr><div id="disqus_thread"></div> <script>var disqus_developer=1,disqus_shortname="RemyG";(function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="http://"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a></div></div><hr> <footer><p><span style="font-family:sans-serif">©</span> 2013 <a href="/">Rémy Gardette</a> with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a> and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a></p><p><a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/88x31.png"/></a> The content of this website is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>.</p> </footer></div> <script src="/assets/themes/flat/bootstrap/js/bootstrap.min.js"></script></body></html>